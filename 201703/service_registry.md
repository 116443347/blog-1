# 基于Docker、Registrator、Zookeeper实现服务自动注册
 
> 摘要：本文属于原创，未经允许不得转载！
 
 
## 当前环境


## 概述
* Docker
* Registrator
* Zookeeper
* springboot


## 原理分析
1. 注册中心：即分布式信息存储的中心服务器，上面保存了各服务节点信息；
2. 服务注册：将服务对外暴露的信息（名称、IP、PORT等）写入注册中心，以供服务消费者使用；
3. 服务发现：获取注册中心上各服务的信息，使用获取的信息向指定地址发起服务调用；


## 流程
1. 启动注册中心；
2. 服务节点路径图：分临时节点、永久节点
2. 服务注册：在指定节点下，创建临时节点，生命周期为服务存活时间；
3. 服务发现：获取服务节点信息，存入本地缓存，同时对节点进行监听；
4. 服务新增、销毁：服务节点变化，通知监听节点的服务消费者进行更新操作；


## 服务注册的两种实现方式
* 服务内注册：在服务内创建连接注册中心的客户端，将服务自身信息注册进注册中心；
* 服务外注册：使用协同进程，监听服务进程的变化，将服务进程的信息注册进注册中心。服务本身无需任何额外配置，服务与注册中心解耦。


## 实例

* 服务构建
* ZK的搭建
* Registrator完成注册

## 高可用
1. ZK注册中心，采用(2n+1)节点部署方式，通过master选举方式，容许n个节点不可用，服务仍旧可用；
2. 服务注册：服务多机器部署，单机器采用多个协同进程进去服务注册，防止单进程不可用。多机器部署，容许单机器不可用；
3. 服务发现：获取注册中心服务节点信息，缓存节点信息，减少网络请求，同时减少对注册中心的依赖，提高服务的可用性；

## 总结


